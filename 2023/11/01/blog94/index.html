<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>单元测试-jest搭建和使用 | 伍新奎的博客空间</title><meta name="author" content="伍新奎"><meta name="copyright" content="伍新奎"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="背景：单元测试是什么测试代码块的可行性通常都使用单元测试。单元测试指检查与验证软件中最小可测试单元。对于单元测试中单元定义，一般来说要根据实际情况判定其具体含义。例如JS中单元指一个函数，Java中单元指一个类，GUI中单元指一个窗口等。简而言之，单元就是人为规定最小的被测功能模块。单元测试是软件开发时要进行的最低级别测试活动，独立单元将在与程序其他部分隔离的情况下进行测试。近几年前端技术高速发展">
<meta property="og:type" content="article">
<meta property="og:title" content="单元测试-jest搭建和使用">
<meta property="og:url" content="http://example.com/2023/11/01/blog94/index.html">
<meta property="og:site_name" content="伍新奎的博客空间">
<meta property="og:description" content="背景：单元测试是什么测试代码块的可行性通常都使用单元测试。单元测试指检查与验证软件中最小可测试单元。对于单元测试中单元定义，一般来说要根据实际情况判定其具体含义。例如JS中单元指一个函数，Java中单元指一个类，GUI中单元指一个窗口等。简而言之，单元就是人为规定最小的被测功能模块。单元测试是软件开发时要进行的最低级别测试活动，独立单元将在与程序其他部分隔离的情况下进行测试。近几年前端技术高速发展">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/blog_wxk.jpg">
<meta property="article:published_time" content="2023-11-01T06:02:00.000Z">
<meta property="article:modified_time" content="2023-12-05T13:00:01.435Z">
<meta property="article:author" content="伍新奎">
<meta property="article:tag" content="单元测试">
<meta property="article:tag" content="jest">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/blog_wxk.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2023/11/01/blog94/index.html"><link rel="preconnect" href="https://lib.baomitu.com"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lib.baomitu.com/font-awesome/6.4.2/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://lib.baomitu.com/fancyapps-ui/5.0.24/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://lib.baomitu.com/egjs-infinitegrid/4.10.1/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '单元测试-jest搭建和使用',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-12-05 21:00:01'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/blog_wxk.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">96</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">150</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">68</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="伍新奎的博客空间"><span class="site-name">伍新奎的博客空间</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">单元测试-jest搭建和使用</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">Created</span><time datetime="2023-11-01T06:02:00.000Z" title="Created 2023-11-01 14:02:00">2023-11-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/">单元测试</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/jest/">jest</a></span></div><div class="meta-secondline"></div></div></div><article class="post-content" id="article-container"><h3 id="背景：单元测试是什么"><a href="#背景：单元测试是什么" class="headerlink" title="背景：单元测试是什么"></a>背景：单元测试是什么</h3><p>测试代码块的可行性通常都使用单元测试。<strong>单元测试</strong>指检查与验证软件中最小可测试单元。对于单元测试中单元定义，一般来说要根据实际情况判定其具体含义。<br>例如JS中单元指一个函数，Java中单元指一个类，GUI中单元指一个窗口等。简而言之，单元就是人为规定最小的被测功能模块。单元测试是软件开发时要进行的最低级别测试活动，独立单元将在与程序其他部分隔离的情况下进行测试。<br>近几年前端技术高速发展，系统功能变得越来越复杂，这对前端工程化的能力提出更高要求，听到工程化的第一反应必然是高质量的代码设计与高质量的代码实现。如何确保这些环节的稳定，那单元测试就必须得应用起来了。<br>单元测试的四大特性就完美诠释了其重要作用。<br><img src="/2023/11/01/blog94/1700449826654-5bb07647-44f3-492a-ac62-c91d64046121.webp"><br>像一些大型前端项目，例如react、vue、babel、webpack等都会接入单元测试，可见单元测试对于这些明星项目来说是多重要的。因为这些大型前端项目需处理大规模的产品及其频繁迭代的功能，这种可持续化的迭代方式迫使它们必须引入自动化测试。进一步看，单元测试有助于增强整体质量与减少运维成本。<br>目前主流的前端单元测试框架主要有jest与mocha，但更推荐使用jest, 因为jest与mocha从多方面对比都有更明显的优势。<br><img src="/2023/11/01/blog94/1700449826627-377a8292-a08a-4d9d-9ac9-6fab5126efca.webp"><br>jest作为一款优秀的前端单元测试框架，有着简单易用、高性能、易配置和多功能的特性，内置监控、断言、快照、模拟、覆盖率等功能，这些功能都能开箱即用，因此是作为类库测试的首选工具。</p>
<h5 id="expect与test"><a href="#expect与test" class="headerlink" title="expect与test"></a>expect与test</h5><p>单元测试有两个很重要的概念函数，分别是expect()与test()。expect()表示期望得到的运行结果，简称期望结果；test()表示测试结果是否通过预期，简称通过状态。以下从一个简单示例了解这两个函数的工作原理。<br>声明一个简单的功能函数Sum()，用于累加入参。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码function Sum(...vals) &#123;</span><br><span class="line">	return vals.reduce((t, v) =&gt; t + v, 0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Sum(1, 2, 3); // 6</span><br></pre></td></tr></table></figure>

<p>若Sum()不小心写错把累加写成累乘，当直接在业务代码中使用该函数就会带来无法预期的Bug，需对该函数进行自动化测试，确保无问题再打包为bundle文件供业务组件调用，这样就保障该函数的准确性。<br>执行以下代码若发现未报错，则表示代码运行结果符合预期。这就是自动化测试最原始的雏形，是一个最简单的单元测试的测试用例。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码const result = Sum(1, 2, 3);</span><br><span class="line">const expect = 6;</span><br><span class="line"></span><br><span class="line">if (result !== expect) &#123;</span><br><span class="line">	throw new Error(`期望是$&#123;expect&#125;，结果是$&#123;result&#125;`);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>把代码改造下变成以下形式，是不是感觉更简洁？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码expect(Sum(1, 2, 3)).toBe(6); // 是否等于9</span><br><span class="line">expect(Sum(1, 2, 3)).toBe(9); // 是否等于10</span><br></pre></td></tr></table></figure>

<p>expect()的实现原理也很简单，入参一个值再返回一个toBe()，当然也可返回更多自定义的期望函数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码function expect(result) &#123;</span><br><span class="line">	return &#123;</span><br><span class="line">		toBe(expect) &#123;</span><br><span class="line">			if (result !== expect) &#123;</span><br><span class="line">				throw new Error(`期望是$&#123;expect&#125;，结果是$&#123;result&#125;`);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行上述两行expect().toBe()代码，结果第二行代码报错。虽然实现了expect()，但报错内容始终一样，不知具体哪个函数出现问题。为了强化expect()的功能，需对其做进一步改良，若在expect()外部再包装一层函数就可传递更多信息进来。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码test(&quot;期望结果是6&quot;, () =&gt; &#123;</span><br><span class="line">	expect(Sum(1, 2, 3)).toBe(6);</span><br><span class="line">&#125;);</span><br><span class="line">test(&quot;期望结果是9&quot;, () =&gt; &#123;</span><br><span class="line">	expect(Sum(1, 2, 3)).toBe(9);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>上述封装既能得到运行结果是否符合期望，又能得到详细的自定义测试描述。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码function test(desc, fn) &#123;</span><br><span class="line">	try &#123;</span><br><span class="line">		fn &amp;&amp; fn();</span><br><span class="line">		console.log(`$&#123;desc&#125; 通过测试`);</span><br><span class="line">	&#125; catch &#123;</span><br><span class="line">		console.log(`$&#123;desc&#125; 未通过测试`);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="自动化测试"><a href="#自动化测试" class="headerlink" title="自动化测试"></a>自动化测试</h5><p>从上述分析可知，自动化测试其实就是编写一些测试函数，通过测试函数运行业务代码，判断实际结果与期望结果是否相符，是则通过，否则不通过，整个过程都是通过预设脚本自动化处理。<br>上述expect()与test()都是主流的前端单元测试框架的内置函数，其语法完全一样，它们在不同前端单元测试框架中的实现原理也大同小异。</p>
<h3 id="方案：基于Jest为类库编写测试用例"><a href="#方案：基于Jest为类库编写测试用例" class="headerlink" title="方案：基于Jest为类库编写测试用例"></a>方案：基于Jest为类库编写测试用例</h3><p>以第15章开发的工具库为例，通过一步一步上手jest，为bruce-us的每个工具函数加入单元测试的测试用例。</p>
<h5 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h5><p>因为使用typescript编码，所以安装jest时也需把typescript相关依赖一起安装。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bash</span><br><span class="line">复制代码npm i -D @types/jest jest ts-jest</span><br></pre></td></tr></table></figure>

<p>在根目录中创建jest.config.js文件，用于配置jest测试配置。jest整体配置简洁明了，可查看<a href="https://link.juejin.cn/?target=https://jestjs.io/zh-Hans">Jest官网</a>，主要用到的配置选项包括preset与testEnvironment。preset表示预设模板，使用安装好的ts-jest模板；testEnvironment表示测试环境，可选web&#x2F;node。<br>ts-jest为jest与typescript环境中的单元测试提供类型检查支持与预处理。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码module.exports = &#123;</span><br><span class="line">	preset: &quot;ts-jest&quot;,</span><br><span class="line">	testEnvironment: &quot;node&quot;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>在package.json中指定scripts，加入测试命令。–no-cache表示每次启动测试脚本不使用缓存；–watchAlls表示监听所有单元测试，若发生更新则重新执行脚本。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">json</span><br><span class="line">复制代码&#123;</span><br><span class="line">	&quot;scripts&quot;: &#123;</span><br><span class="line">		&quot;test&quot;: &quot;jest --no-cache --watchAll&quot;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在tsconfig.json中指定types，加入@types&#x2F;jest。@types&#x2F;jest提供了expect()与test()。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">json</span><br><span class="line">复制代码&#123;</span><br><span class="line">	&quot;compilerOptions&quot;: &#123;</span><br><span class="line">		&quot;types&quot;: [</span><br><span class="line">			&quot;@types/jest&quot;</span><br><span class="line">		]</span><br><span class="line">	&#125;,</span><br><span class="line">	&quot;exclude&quot;: [</span><br><span class="line">		&quot;jest.config.js&quot;</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h5><p>在根目录中创建test文件夹。test文件夹内部的目录结构可参照src文件夹，保持源码与测试脚本的目录结构一样，方便后续迭代与维护。单元测试的测试用例使用xyz.spec.ts的方式命名。因为文件众多，那些非重要的文件就不展示了。另外src文件夹中的index.ts、node.ts和web.ts三种文件是供rollup识别入口，因此无需加入对应测试用例文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">txt</span><br><span class="line">复制代码bruce-us</span><br><span class="line">├─ src</span><br><span class="line">│  ├─ common</span><br><span class="line">│  │  ├─ array.ts</span><br><span class="line">│  │  ├─ boolean.ts</span><br><span class="line">│  │  ├─ date.ts</span><br><span class="line">│  │  ├─ function.ts</span><br><span class="line">│  │  ├─ number.ts</span><br><span class="line">│  │  ├─ object.ts</span><br><span class="line">│  │  ├─ regexp.ts</span><br><span class="line">│  │  └─ string.ts</span><br><span class="line">│  ├─ node</span><br><span class="line">│  │  ├─ fs.ts</span><br><span class="line">│  │  ├─ os.ts</span><br><span class="line">│  │  ├─ process.ts</span><br><span class="line">│  │  └─ type.ts</span><br><span class="line">│  └─ web</span><br><span class="line">│     ├─ cookie.ts</span><br><span class="line">│     ├─ dom.ts</span><br><span class="line">│     ├─ function.ts</span><br><span class="line">│     ├─ storage.ts</span><br><span class="line">│     ├─ type.ts</span><br><span class="line">│     └─ url.ts</span><br><span class="line">├─ test</span><br><span class="line">│  ├─ common</span><br><span class="line">│  │  ├─ array.spec.ts</span><br><span class="line">│  │  ├─ boolean.spec.ts</span><br><span class="line">│  │  ├─ date.spec.ts</span><br><span class="line">│  │  ├─ function.spec.ts</span><br><span class="line">│  │  ├─ number.spec.ts</span><br><span class="line">│  │  ├─ object.spec.ts</span><br><span class="line">│  │  ├─ regexp.spec.ts</span><br><span class="line">│  │  └─ string.spec.ts</span><br><span class="line">│  ├─ node</span><br><span class="line">│  │  ├─ fs.spec.ts</span><br><span class="line">│  │  ├─ os.spec.ts</span><br><span class="line">│  │  ├─ process.spec.ts</span><br><span class="line">│  │  └─ type.spec.ts</span><br><span class="line">|  └─ web</span><br><span class="line">|     ├─ cookie.spec.ts</span><br><span class="line">|     ├─ dom.spec.ts</span><br><span class="line">|     ├─ function.spec.ts</span><br><span class="line">|     ├─ storage.spec.ts</span><br><span class="line">|     ├─ type.spec.ts</span><br><span class="line">|     └─ url.spec.ts</span><br></pre></td></tr></table></figure>

<p>先将上述Sum()走一次测试用例。在test文件夹中创建index.spec.ts文件，加入以下内容。打开CMD工具，执行npm run test，输出以下信息表示测试通过。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ts</span><br><span class="line">复制代码function Sum(...vals: number[]): number &#123;</span><br><span class="line">	return vals.reduce((t, v) =&gt; t + v, 0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test(&quot;期望结果是6&quot;, () =&gt; &#123;</span><br><span class="line">	expect(Sum(1, 2, 3)).toBe(6);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/01/blog94/1700449826640-622edd48-af1b-414a-a272-a4677d027eae.webp"><br>加入以下代码，测试脚本会重新执行，输出以下信息表示测试不通过。第二段expect().toBe()测试不通过，期待结果是9，运行结果是6。当修正期待结果就会自动通过测试了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ts</span><br><span class="line">复制代码test(&quot;期望结果是9&quot;, () =&gt; &#123;</span><br><span class="line">	expect(Sum(1, 2, 3)).toBe(9);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><img src="/2023/11/01/blog94/1700449826624-83b8b6d6-10ea-4b93-828e-263c23581b46.webp"><br>通过上述操作说明jest已被部署到bruce-us中了。因为工具函数众多，因此选取一个工具函数为例，后续有时间可一起完善bruce-us的测试用例。</p>
<h5 id="代码覆盖测试"><a href="#代码覆盖测试" class="headerlink" title="代码覆盖测试"></a>代码覆盖测试</h5><p>上述单元测试只不过是验证运行结果是否符合预期，着重于结果。若产生一个运行结果的过程可能存在多个分支，例如以下加强版的Sum()，总共有3个分支，Sum(1, 2, 3)只满足其中一个分支，验证完毕也只占整个函数的33.33%，剩下66.66%的代码还未能验证，那就不能百分百认为该单元测试成功通过。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ts</span><br><span class="line">复制代码function Sum(...vals: number[]): number &#123;</span><br><span class="line">	if (vals.length === 0) &#123;</span><br><span class="line">		return -1;</span><br><span class="line">	&#125; else if (vals.length === 1) &#123;</span><br><span class="line">		return 0;</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		return vals.reduce((t, v) =&gt; t + v, 0);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>若要将整个Sum()验证完毕，必须将所有if-else语句验证一遍，当全部满足条件才能百分百认为该单元测试成功通过。这就引入一个测试概念，代码覆盖测试。<br><strong>代码覆盖测试</strong>指程序源码被测试的比例与程度的所得比例。代码覆盖测试生成的指标称为代码覆盖率，它作为一个指导性指标，可在一定程度上反应测试的完备程度，是软件质量度量的重要手段。100%覆盖率的代码并不意味着100%无Bug，代码覆盖率作为质量目标无任何意义，应把它作为一种发现未被测试覆盖的代码的检查手段。简而言之，代码覆盖测试更注重测试过程，而测试结果只是测试过程的一个表现。<br>jest本身内置代码覆盖测试，改良上述配置就能运行代码覆盖测试了。修改jest.config.js的配置，追加coverage相关配置。修改package.json中scripts的test，追加–coverage。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码module.exports = &#123;</span><br><span class="line">	coverageDirectory: &quot;coverage&quot;,</span><br><span class="line">	coverageProvider: &quot;v8&quot;,</span><br><span class="line">	coverageThreshold: &#123;</span><br><span class="line">		global: &#123;</span><br><span class="line">			branches: 100,</span><br><span class="line">			functions: 100,</span><br><span class="line">			lines: 100,</span><br><span class="line">			statements: 100</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	preset: &quot;ts-jest&quot;,</span><br><span class="line">	testEnvironment: &quot;node&quot;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">json</span><br><span class="line">复制代码&#123;</span><br><span class="line">	&quot;scripts&quot;: &#123;</span><br><span class="line">		&quot;test&quot;: &quot;jest --no-cache --watchAll --coverage&quot;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>改动<a href="https://link.juejin.cn/?target=https://github.com/JowayYoung/bruce/blob/main/packages/us/test/index.spec.ts">test&#x2F;index.spec.ts</a>的代码，因为代码改动较大就不贴出来了。测试脚本会重新执行，输出以下信息表示测试通过，但覆盖率未完全通过。<br><img src="/2023/11/01/blog94/1700449826665-fa21c528-41d3-4614-b2d0-47ec6740ff10.webp"><br>这是一个关于测试覆盖率的说明，从中可知四个测试用例都通过，但覆盖率只有76.19%，不通过的部分集中在Branch。那这些带有%的参数表示什么含义？</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><strong>%Stmts</strong></td>
<td>语句覆盖率</td>
<td>是否每个语句都执行</td>
</tr>
<tr>
<td><strong>%Branch</strong></td>
<td>分支覆盖率</td>
<td>是否每个条件都执行</td>
</tr>
<tr>
<td><strong>%Funcs</strong></td>
<td>函数覆盖率</td>
<td>是否每个函数都调用</td>
</tr>
<tr>
<td><strong>%Lines</strong></td>
<td>行覆盖率</td>
<td>是否每行代码都执行</td>
</tr>
</tbody></table>
<p>其中%Stmts与%Lines可能有些歧义，有缩写代码或压缩代码的情况下，行覆盖率的颗粒度可能大于语句覆盖率，因为可允许一行代码包括多条语句。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ts</span><br><span class="line">复制代码function Sum(...vals: number[]): number &#123;</span><br><span class="line">	if (vals.length === 0) &#123; return -1; &#125; else if (vals.length === 1) &#123; return 0; &#125; else &#123; return vals.reduce((t, v) =&gt; t + v, 0); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>除了在控制台输出图表信息，还会生成一个coverage文件夹，点击index.html就会打开一个详细的测试报告，可根据测试报告的详细信息完善单元测试的细节。<br><img src="/2023/11/01/blog94/1700449827032-48100107-6c09-42b3-9922-5603efca44c0.webp"><br><img src="/2023/11/01/blog94/1700449827038-86425b7c-d6d5-40e9-9895-4ac3cc2f6802.webp"></p>
<h3 id="使用：认识常见匹配器"><a href="#使用：认识常见匹配器" class="headerlink" title="使用：认识常见匹配器"></a>使用：认识常见匹配器</h3><p>上述代码都有用到expect()、test()和toBe()三个函数，它们组合起来表示一个测试用例中运行结果匹配期待结果，检验是否符合某种匹配状态。该匹配状态又称匹配器，可能是值相等、值全等、满足范围值等。<br>toBe()是一个使用频率很高的匹配器，除了它，jest还提供一些很好用的匹配器。</p>
<h5 id="toBe"><a href="#toBe" class="headerlink" title="toBe()"></a>toBe()</h5><p>检查对象是否全等某值，类似&#x3D;&#x3D;&#x3D;。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码test(&quot;值是否相等3&quot;, () =&gt; &#123;</span><br><span class="line">	expect(1 + 2).toBe(3); // 通过</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="toBeLessThan"><a href="#toBeLessThan" class="headerlink" title="toBeLessThan()"></a>toBeLessThan()</h5><p>检查对象是否小于某值，类似&lt;。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码test(&quot;值是否小于3&quot;, () =&gt; &#123;</span><br><span class="line">	expect(1 + 2).toBeLessThan(3); // 不通过</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="toBeGreaterThan"><a href="#toBeGreaterThan" class="headerlink" title="toBeGreaterThan()"></a>toBeGreaterThan()</h5><p>检查对象是否大于某值，类似&gt;。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码test(&quot;值是否大于3&quot;, () =&gt; &#123;</span><br><span class="line">	expect(1 + 2).toBeGreaterThan(3); // 不通过</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="toBeLessThanOrEqual"><a href="#toBeLessThanOrEqual" class="headerlink" title="toBeLessThanOrEqual()"></a>toBeLessThanOrEqual()</h5><p>检查对象是否小于等于某值，类似&lt;&#x3D;。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码test(&quot;值是否小于等于3&quot;, () =&gt; &#123;</span><br><span class="line">	expect(1 + 2).toBeLessThanOrEqual(3); // 通过</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="toBeGreaterThanOrEqual"><a href="#toBeGreaterThanOrEqual" class="headerlink" title="toBeGreaterThanOrEqual()"></a>toBeGreaterThanOrEqual()</h5><p>检查对象是否大于等于某值，类似&gt;&#x3D;。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码test(&quot;值是否大于等于3&quot;, () =&gt; &#123;</span><br><span class="line">	expect(1 + 2).toBeGreaterThanOrEqual(3); // 通过</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="toBeCloseTo"><a href="#toBeCloseTo" class="headerlink" title="toBeCloseTo()"></a>toBeCloseTo()</h5><p>检查对象是否约等于某值，类似≈。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码test(&quot;0.1+0.2是否约等于0.3&quot;, () =&gt; &#123;</span><br><span class="line">	expect(0.1 + 0.2).toBe(0.3); // 不通过</span><br><span class="line">	expect(0.1 + 0.2).toBeCloseTo(0.3); // 通过</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="toEqual"><a href="#toEqual" class="headerlink" title="toEqual()"></a>toEqual()</h5><p>测试两个对象的值是否相等，只对比值，不对比引用地址。该函数用在引用类型中更佳，例如数组与对象。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码test(&quot;两数组的内容是否相等&quot;, () =&gt; &#123;</span><br><span class="line">	const arr1 = [0, 1, 2];</span><br><span class="line">	const arr2 = [0, 1, 2];</span><br><span class="line">	expect(arr1).toEqual(arr2); // 通过</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="toBeUndefined"><a href="#toBeUndefined" class="headerlink" title="toBeUndefined()"></a>toBeUndefined()</h5><p>检查对象是否为undefined。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码test(&quot;值是否为undefined&quot;, () =&gt; &#123;</span><br><span class="line">	const val = undefined;</span><br><span class="line">	expect(val).toBeUndefined(); // 通过</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="toBeNull"><a href="#toBeNull" class="headerlink" title="toBeNull()"></a>toBeNull()</h5><p>检查对象是否为null。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码test(&quot;值是否为null&quot;, () =&gt; &#123;</span><br><span class="line">	const val = null;</span><br><span class="line">	expect(val).toBeNull(); // 通过</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="toBeTruthy"><a href="#toBeTruthy" class="headerlink" title="toBeTruthy()"></a>toBeTruthy()</h5><p>检查对象转换为布尔后是否为true。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码test(&quot;转换值是否为true&quot;, () =&gt; &#123;</span><br><span class="line">	expect(undefined).toBeTruthy(); // 不通过</span><br><span class="line">	expect(null).toBeTruthy(); // 不通过</span><br><span class="line">	expect(&quot;&quot;).toBeTruthy(); // 不通过</span><br><span class="line">	expect(0).toBeTruthy(); // 不通过</span><br><span class="line">	expect(false).toBeTruthy(); // 不通过</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="toBeFalsy"><a href="#toBeFalsy" class="headerlink" title="toBeFalsy()"></a>toBeFalsy()</h5><p>检查对象转换为布尔后是否为false。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码test(&quot;转换值是否为false&quot;, () =&gt; &#123;</span><br><span class="line">	expect(undefined).toBeFalsy(); // 通过</span><br><span class="line">	expect(null).toBeFalsy(); // 通过</span><br><span class="line">	expect(&quot;&quot;).toBeFalsy(); // 通过</span><br><span class="line">	expect(0).toBeFalsy(); // 通过</span><br><span class="line">	expect(false).toBeFalsy(); // 通过</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="toMatch"><a href="#toMatch" class="headerlink" title="toMatch()"></a>toMatch()</h5><p>检查对象是否包括字符串或匹配正则，类似字符串的includes()与match()。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码test(&quot;值是否被匹配&quot;, () =&gt; &#123;</span><br><span class="line">	expect(&quot;https://yangzw.vip&quot;).toMatch(&quot;yangzw&quot;); // 通过</span><br><span class="line">	expect(&quot;https://yangzw.vip&quot;).toMatch(/^https/); // 通过</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="toContain"><a href="#toContain" class="headerlink" title="toContain()"></a>toContain()</h5><p>检查对象是否被数组包括，类似数组的includes()。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">js</span><br><span class="line">复制代码test(&quot;值是否被包括&quot;, () =&gt; &#123;</span><br><span class="line">	const list = [0, 1, 2];</span><br><span class="line">	expect(list).toContain(1); // 通过</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>基本上掌握上述函数就能应付很多需求，当然想了解更多期望函数，可查看<a href="https://link.juejin.cn/?target=https://jestjs.io/zh-Hans/docs/expect">Jest预期函数</a>。</p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/">单元测试</a><a class="post-meta__tags" href="/tags/jest/">jest</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/11/15/blog90/" title="前端工程化- webpack | 项目打包webpack优化"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">前端工程化- webpack | 项目打包webpack优化</div></div></a></div><div class="next-post pull-right"><a href="/2023/10/20/blog93/" title="nodejs-PM2搭建和使用"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">nodejs-PM2搭建和使用</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/blog_wxk.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">伍新奎</div><div class="author-info__description">前端开发工程师</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">96</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">150</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">68</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xinkuiwu"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%83%8C%E6%99%AF%EF%BC%9A%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">1.</span> <span class="toc-text">背景：单元测试是什么</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#expect%E4%B8%8Etest"><span class="toc-number">1.0.1.</span> <span class="toc-text">expect与test</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95"><span class="toc-number">1.0.2.</span> <span class="toc-text">自动化测试</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%88%EF%BC%9A%E5%9F%BA%E4%BA%8EJest%E4%B8%BA%E7%B1%BB%E5%BA%93%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B"><span class="toc-number">2.</span> <span class="toc-text">方案：基于Jest为类库编写测试用例</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">2.0.1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95"><span class="toc-number">2.0.2.</span> <span class="toc-text">单元测试</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E8%A6%86%E7%9B%96%E6%B5%8B%E8%AF%95"><span class="toc-number">2.0.3.</span> <span class="toc-text">代码覆盖测试</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%EF%BC%9A%E8%AE%A4%E8%AF%86%E5%B8%B8%E8%A7%81%E5%8C%B9%E9%85%8D%E5%99%A8"><span class="toc-number">3.</span> <span class="toc-text">使用：认识常见匹配器</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#toBe"><span class="toc-number">3.0.1.</span> <span class="toc-text">toBe()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#toBeLessThan"><span class="toc-number">3.0.2.</span> <span class="toc-text">toBeLessThan()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#toBeGreaterThan"><span class="toc-number">3.0.3.</span> <span class="toc-text">toBeGreaterThan()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#toBeLessThanOrEqual"><span class="toc-number">3.0.4.</span> <span class="toc-text">toBeLessThanOrEqual()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#toBeGreaterThanOrEqual"><span class="toc-number">3.0.5.</span> <span class="toc-text">toBeGreaterThanOrEqual()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#toBeCloseTo"><span class="toc-number">3.0.6.</span> <span class="toc-text">toBeCloseTo()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#toEqual"><span class="toc-number">3.0.7.</span> <span class="toc-text">toEqual()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#toBeUndefined"><span class="toc-number">3.0.8.</span> <span class="toc-text">toBeUndefined()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#toBeNull"><span class="toc-number">3.0.9.</span> <span class="toc-text">toBeNull()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#toBeTruthy"><span class="toc-number">3.0.10.</span> <span class="toc-text">toBeTruthy()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#toBeFalsy"><span class="toc-number">3.0.11.</span> <span class="toc-text">toBeFalsy()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#toMatch"><span class="toc-number">3.0.12.</span> <span class="toc-text">toMatch()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#toContain"><span class="toc-number">3.0.13.</span> <span class="toc-text">toContain()</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/12/05/blog96/" title="nestjs学习-5种http数据传输方式">nestjs学习-5种http数据传输方式</a><time datetime="2023-12-05T12:02:00.000Z" title="Created 2023-12-05 20:02:00">2023-12-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/23/blog95/" title="nestjs学习-快速掌握 Nest CLI">nestjs学习-快速掌握 Nest CLI</a><time datetime="2023-11-23T08:02:00.000Z" title="Created 2023-11-23 16:02:00">2023-11-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/15/blog90/" title="前端工程化- webpack | 项目打包webpack优化">前端工程化- webpack | 项目打包webpack优化</a><time datetime="2023-11-15T03:02:00.000Z" title="Created 2023-11-15 11:02:00">2023-11-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/01/blog94/" title="单元测试-jest搭建和使用">单元测试-jest搭建和使用</a><time datetime="2023-11-01T06:02:00.000Z" title="Created 2023-11-01 14:02:00">2023-11-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/10/20/blog93/" title="nodejs-PM2搭建和使用">nodejs-PM2搭建和使用</a><time datetime="2023-10-20T03:02:00.000Z" title="Created 2023-10-20 11:02:00">2023-10-20</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2023 By 伍新奎</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://lib.baomitu.com/fancyapps-ui/5.0.24/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div></div></body></html>