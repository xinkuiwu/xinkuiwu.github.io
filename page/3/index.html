<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>伍新奎的博客空间 - Talk is cheap, code the code</title><meta name="author" content="伍新奎"><meta name="copyright" content="伍新奎"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前端开发工程师">
<meta property="og:type" content="website">
<meta property="og:title" content="伍新奎的博客空间">
<meta property="og:url" content="http://example.com/page/3/index.html">
<meta property="og:site_name" content="伍新奎的博客空间">
<meta property="og:description" content="前端开发工程师">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/blog_wxk.jpg">
<meta property="article:author" content="伍新奎">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/blog_wxk.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/page/3/index.html"><link rel="preconnect" href="https://lib.baomitu.com"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lib.baomitu.com/font-awesome/6.4.2/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://lib.baomitu.com/fancyapps-ui/5.0.24/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://lib.baomitu.com/egjs-infinitegrid/4.10.1/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '伍新奎的博客空间',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-12-05 17:44:36'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/blog_wxk.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">83</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">134</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">57</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="伍新奎的博客空间"><span class="site-name">伍新奎的博客空间</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2021/09/10/blog61/" title="typeorm-model-generator 生成TypeOrm实体类">typeorm-model-generator 生成TypeOrm实体类</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-09-10T02:01:01.000Z" title="Created 2021-09-10 10:01:01">2021-09-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/nodejs/">nodejs</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/typeorm-model-generator%EF%BC%8Cnodejs/">typeorm-model-generator，nodejs</a></span></div><div class="content">

TypeOrm 支持 synchronize 这样直接同步entity到db的功能，不过这个用在线上有太大的风险。
并且目前我们的开发模式主要是先进行库表设计，再构建entity实体类进行开发；再就是对于已经有的库表，想使用的时候也需要自己构建entity；这样一来，维护本地entity于db中table的一致性，或者按照远程db中的table组装entity类比较繁琐。
typeorm-model-generator 这个工具可以直接连接对应db直接生成entity，方便使用，提升开发效率.
工具地址
https://github.com/Kononnable/typeorm-model-generator
目前这个项目处于只维护状态

直接使用npx 运行会少包导致运行失败

考虑到作者已经不怎么维护这个项目了，直接clone一份本地跑一下吧
1git clone https:``//github.com/Kononnable/typeorm-model-generator.git &amp;&amp; cd typeorm-model-generator &amp;&amp; ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2021/08/30/blog69/" title="代码检查工具">代码检查工具</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-08-30T08:02:03.000Z" title="Created 2021-08-30 16:02:03">2021-08-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%A7%84%E8%8C%83/">规范</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%A7%84%E8%8C%83/">规范</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E4%BB%A3%E7%A0%81%E6%A3%80%E6%9F%A5/">代码检查</a></span></div><div class="content">在vscode中安装ESLint和Stylelint，可以在保存代码时自动检查代码和格式化代码。

eslint和stylelint的配置中所需的插件已经集成在脚手架中， 无需单独配置
eslint和stylelint的vscode配置，已经保存在.vscode&#x2F;settings.json中，无需单独配置

一、ESLint：JavaScript编码规范（含React）1、使用eslint约束JavaScript的编写，集成以下插件规则：

react&#x2F;recommended：React规则
react-hooks&#x2F;recommended：React hooks规则
standard：代码质量检查
prettier&#x2F;recommended：代码格式检查

2、以下规则和最佳实践，供参考：

Google JavaScript Style Guide：https://google.github.io/styleguide/jsguide.html
Airbnb JavaScript Style Guide：https://github.com/ai ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2021/08/29/blog75/" title="React&amp;JSX 规范">React&amp;JSX 规范</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-08-29T01:02:03.000Z" title="Created 2021-08-29 09:02:03">2021-08-29</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/React/">React</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%A7%84%E8%8C%83/">规范</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/React/">React</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/JSX/">JSX</a></span></div><div class="content">React&amp;JSX 规范
本规范基本基于标准的 JavaScript 语法规范

基本规则
每个文件只包含一个 React 类组件
但是多个函数式组件可以放到一个文件中，eslint: react&#x2F;no-multi-comp


一般使用 JSX 语法
除非是在非 JSX 文件中初始化应用，否则不要使用 React.createElement

命名规范
组件文件扩展名

如果使用 JavaScript，则文件扩展名为 .js；如果使用 TypeScript，则文件扩展名为 .tsx

组件文件名

如果是组件文件，则使用 PascalCase，如 MyComponent.js
如果组件是一个目录，则组件主入口命名为 index，如 index.js

引用命名

React 组件使用 PascalCase，组件实例使用 CamelCase，eslint: react&#x2F;jsx-pascal-case
1234567891011// badimport reservationCard from &#x27;./ReservationCard&#x27;// g ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2021/08/14/blog60/" title="Nodejs监控方案">Nodejs监控方案</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-08-14T03:00:01.000Z" title="Created 2021-08-14 11:00:01">2021-08-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/nodejs/">nodejs</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E7%9B%91%E6%8E%A7%EF%BC%8Cnodejs/">监控，nodejs</a></span></div><div class="content">

Nodejs监控方案BFF 上线后，未提供监控能力，无法主动发现报错、接口性能等，需要有相应的指标监控 BFF 程序运行状况。
本方案以监控 BFF （Nest.js 应用），描述从指标制定到查看数据面板的过程。
目标BFF 的监控主要包含系统监控、服务监控、业务监控、报警响应四大类
监控指标


类型
指标类
指标名
描述



系统监控
容器指标
容器 CPU
Pod CPU 使用率


进程指标
进程 CPU
进程 CPU 使用率



服务监控
HTTP 指标
接口 QPS
所有接口请求量


接口 P99 延时
接口响应时间，取前 99%




接口 P95 延时
接口响应时间，取前 99%




接口成功率
http 状态码 200




RPC指标
同HTTP指标
&#x2F;



Spex指标
同HTTP指标
&#x2F;



业务监控
业务指标
根据业务具体场景而定
&#x2F;


报警响应
支持报警规则配置
支持邮件通知业务 owner

架构设计
主要架构模块按功能类别主要划分为三个类模块。

监控 SDK
以项目（Project）维度， 每个项目 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2021/07/25/blog59/" title="MySQL开发规范">MySQL开发规范</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-07-25T06:00:01.000Z" title="Created 2021-07-25 14:00:01">2021-07-25</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%A7%84%E8%8C%83/">规范</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%A7%84%E8%8C%83%EF%BC%8CMySQL/">规范，MySQL</a></span></div><div class="content">介绍：MySQL 开发规范


MySQL开发规范MySQL 开发规范背景对目前Node项目内的MYSQL开发方式拟定一个大致的规范。
命名规范
统一按照lower_case_with_underscores的命名方式
禁止使用mysql的关键字和保留字
命名的length长度小于32

DB
以_db为后缀，如account_db, shopee_account_db
以业务代码为前缀，如shopee_account_db, gop_txn_db
如果db是单独为某个region，如shopee_admin_vn_db
如果要分库，把sharding id放到_db后面，sharding id从0开始，占8位，如shopee_seller_dms_sg_db和shopee_seller_dms_id_db_00001000
db名称长度需要小于42(DBA)

Table
以_tab为后缀，表名不适用复数名词，如果要分表，把sharding id放到_tab后面，sharding id从0开始，占8位 ，如order_tab_00000000和login_log_tab_002018 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2021/07/16/blog58/" title="项目结构规范">项目结构规范</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-07-16T08:00:01.000Z" title="Created 2021-07-16 16:00:01">2021-07-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E8%A7%84%E8%8C%83/">规范</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%A7%84%E8%8C%83%EF%BC%8C%E9%A1%B9%E7%9B%AE/">规范，项目</a></span></div><div class="content">介绍：项目结构规范


React项目结构规范|– src  只能修改src目录下的文件
   |– assets  图片、字体等资源文件
​      |– favicon.ico  站点头像
​      |– logo.png  站点logo
   |– common  各个页面间共用的文件
​      |– components  公共组件
​      |– constants  常量
​      |– contexts  全局contexts
​      |– hooks  hooks
​      |– layout  页面布局相关的文件
​      |– utils  工具函数
   |– config  配置相关
​      |– appConfig.js  app的配置
​      |– config.js  mock的配置
​      |– routes.jsx  app的路由
   |– mock  mock数据
​      |– data  mock数据模块
​      |– config.js  mock的配置
​      |– serv ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2020/08/16/blog57/" title="腾讯实习总结">腾讯实习总结</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2020-08-16T08:00:01.000Z" title="Created 2020-08-16 16:00:01">2020-08-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%AE%9E%E4%B9%A0/">实习</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%85%BE%E8%AE%AF/">腾讯</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/TEG-%E5%AE%9E%E4%B9%A0/">TEG 实习</a></span></div><div class="content">介绍：这是关于暑期去腾讯实习项目的总结复盘
项目：实习内容、心得、启发的总结与反思
技术栈：PHP，CodeIgniter(MVC 框架)，MySQL，vue，iview UI，axios。


腾讯实习总结岗位：TEG技术工程事业群&#x2F;网络平台部&#x2F;网络运营中心&#x2F;运营开发组&#x2F;运营开发岗
背景：网络平台部是负责整个腾讯公司网络相关的东西。网络的生命周期很长，到硬件，到软件，到架构，到机房运营，到网络运营。我在的中心是负责网络运营的，例如做些机房管理、网络架构设计，专线扩容&#x2F;切换，变更管理（例如设备升级等）等等。我们组是负责做一些关于网络运营管理工具平台的开发（devOps模式，开发的平台跟用户的业务逻辑完全区分开），当出现网络设备系统升级等变更需求时，此时平台可提供通用的流程模板，用于用户自定义处理方案，从而执行网络变更。（里面涉及错误流程的紧急回退等等）
工作需求：为了进一步提升NC变更平台的问题复盘效率以及实现追溯模板历史能力，我们需实现NC平台的模板日志功能，能够记录变更模板的创建、信息修改以及生成对应模板版本，并且能对比出不同模板版 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2020/05/16/blog56/" title="node自学之Nodejs 路由模块封装、封装仿照express的路由">node自学之Nodejs 路由模块封装、封装仿照express的路由</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2020-05-16T07:12:00.000Z" title="Created 2020-05-16 15:12:00">2020-05-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/node/">node</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/node/">node</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%9D%97%E5%B0%81%E8%A3%85/">路由模块封装</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/express%E8%B7%AF%E7%94%B1/">express路由</a></span></div><div class="content">终极目标：掌握和使用node
本博客目的：记录node学习的进度和心得
内容：Nodejs中的路由模块封装、封装仿照express的路由。


路由模块封装（模块化的方式封装）​	上一个blog，我们把get和post操作都写到了服务器代码中，显得很大很臃肿，应该进行封装。
​	所以我们创建模块，把所有的路由操作封装在这个文件里面：

model.js，即把路由以属性的方式封装到app对象，最后导出这个app对象：
1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859var ejs=require(&#x27;ejs&#x27;);var fs=require(&#x27;fs&#x27;);var app=&#123;    //login 路由    login:function(req,res)&#123;        console.log(&#x27;login&#x27;);        //res.end ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2020/05/15/blog55/" title="node自学之NodeJs WEB服务器、静态文件托管、 路由、EJS模板引擎、GET、POST">node自学之NodeJs WEB服务器、静态文件托管、 路由、EJS模板引擎、GET、POST</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2020-05-15T06:02:06.000Z" title="Created 2020-05-15 14:02:06">2020-05-15</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/node/">node</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%B7%AF%E7%94%B1/">路由</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/node/">node</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/WEB%E6%9C%8D%E5%8A%A1%E5%99%A8/">WEB服务器</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E6%89%98%E7%AE%A1/">静态文件托管</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/EJS%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/">EJS模板引擎</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/GET/">GET</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/POST/">POST</a></span></div><div class="content">终极目标：掌握和使用node
本博客目的：记录node学习的进度和心得
内容：Nodejs中的NodeJs WEB服务器、静态文件托管、 路由、EJS模板引擎、GET、POST。


Nodejs 静态文件托管​	上一个blog介绍了如何使用nodejs创建一个WEB服务器，用于静态文件托管。
​	但我们会发现，大量的代码写在一块，比较混乱。其实我们可以把一些代码封装为一个模块（router.js），然后使得服务器代码简化：

​	即大量的读取文件等操作（路由操作），封装为一个router.js文件
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172var fs=require(&#x27;fs&#x27;);var path=require(&#x27;path&#x27;);  var url=require(&#x27;url&#x27;);function ge ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2020/05/14/blog54/" title="node自学之Nodejs的非阻塞I/O、异步、事件驱动">node自学之Nodejs的非阻塞I/O、异步、事件驱动</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2020-05-14T08:38:22.000Z" title="Created 2020-05-14 16:38:22">2020-05-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/node/">node</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/node/">node</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E9%9D%9E%E9%98%BB%E5%A1%9EI-O/">非阻塞I/O</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E5%BC%82%E6%AD%A5/">异步</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E4%BA%8B%E4%BB%B6%E9%A9%B1%E5%8A%A8/">事件驱动</a></span></div><div class="content">终极目标：掌握和使用node
本博客目的：记录node学习的进度和心得
内容：Nodejs中的Nodejs的非阻塞I&#x2F;O、异步、事件驱动。


Nodejs的单线程、非阻塞I&#x2F;O、事件驱动​	在Java、PHP或者.net等服务器端语言中，会为每一个客户端连接创建一个新的线程。而每个线程需要耗费大约2MB内存。也就是说，理论上，一个8GB内存的服务器可以同时连接的最大用户数为4000个左右。要让Web应用程序支持更多的用户，就需要增加服务器的数量，而Web应用程序的硬件成本当然就上升了。 (高并发场景)
​	Node.js不为每个客户连接创建一个新的线程，而仅仅使用一个线程。当有用户连接了，就触发一个内部事件，通过非阻塞I&#x2F;O、事件驱动机制，让Node.js程序宏观上也是并行的。使用Node.js，一个8GB内存的服务器，可以同时处理超过4万用户的连接。
​	之前，我们使用fs模块的readFile方法是一个异步方法，或者说是非阻塞式IO。
​	所以代码：
​	
​	结果：

但是，当我们在外部使用这个异步方法的时候，会出undefined

因为，这个方 ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/#content-inner">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/#content-inner">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/#content-inner">9</a><a class="extend next" rel="next" href="/page/4/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/blog_wxk.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">伍新奎</div><div class="author-info__description">前端开发工程师</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">83</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">134</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">57</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xinkuiwu"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/04/25/blog83/" title="npm 发布小版本更新">npm 发布小版本更新</a><time datetime="2023-04-25T11:01:00.000Z" title="Created 2023-04-25 19:01:00">2023-04-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/18/blog82/" title="组件设计原则">组件设计原则</a><time datetime="2023-03-18T10:01:00.000Z" title="Created 2023-03-18 18:01:00">2023-03-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/02/16/blog81/" title="vim|webstorm快捷键学习">vim|webstorm快捷键学习</a><time datetime="2023-02-16T03:01:00.000Z" title="Created 2023-02-16 11:01:00">2023-02-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/01/10/blog80/" title="chrome调试技巧 - network">chrome调试技巧 - network</a><time datetime="2023-01-10T04:01:00.000Z" title="Created 2023-01-10 12:01:00">2023-01-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/12/26/blog79/" title="PDF 下载">PDF 下载</a><time datetime="2022-12-26T03:02:03.000Z" title="Created 2022-12-26 11:02:03">2022-12-26</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>Categories</span>
            <a class="card-more-btn" href="/categories/" title="View More">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/React/"><span class="card-category-list-name">React</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/VScode-%E9%85%8D%E7%BD%AE/"><span class="card-category-list-name">VScode 配置</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/antd/"><span class="card-category-list-name">antd</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/backend/"><span class="card-category-list-name">backend</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/chrome/"><span class="card-category-list-name">chrome</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/git/"><span class="card-category-list-name">git</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/hive/"><span class="card-category-list-name">hive</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/mysql/"><span class="card-category-list-name">mysql</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>Tags</span></div><div class="card-tag-cloud"><a href="/tags/%E5%BC%82%E6%AD%A5/" style="font-size: 1.1em; color: #999">异步</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E5%B0%81%E8%A3%85/" style="font-size: 1.1em; color: #999">网络请求封装</a> <a href="/tags/chrome/" style="font-size: 1.1em; color: #999">chrome</a> <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" style="font-size: 1.1em; color: #999">动态规划</a> <a href="/tags/ES6/" style="font-size: 1.4em; color: #99a5b6">ES6</a> <a href="/tags/%E7%9B%91%E6%8E%A7%EF%BC%8Cnodejs/" style="font-size: 1.1em; color: #999">监控，nodejs</a> <a href="/tags/React/" style="font-size: 1.3em; color: #99a1ac">React</a> <a href="/tags/supervisor%E5%B7%A5%E5%85%B7/" style="font-size: 1.1em; color: #999">supervisor工具</a> <a href="/tags/%E7%BB%84%E4%BB%B6%E5%8C%96/" style="font-size: 1.1em; color: #999">组件化</a> <a href="/tags/%E9%97%AD%E5%8C%85/" style="font-size: 1.1em; color: #999">闭包</a> <a href="/tags/vite/" style="font-size: 1.2em; color: #999da3">vite</a> <a href="/tags/HTTP%E6%A8%A1%E5%9D%97/" style="font-size: 1.1em; color: #999">HTTP模块</a> <a href="/tags/%E5%BE%AE%E5%89%8D%E7%AB%AF/" style="font-size: 1.1em; color: #999">微前端</a> <a href="/tags/vue%E9%85%8D%E7%BD%AE/" style="font-size: 1.1em; color: #999">vue配置</a> <a href="/tags/%E4%BA%8C%E5%8F%89%E5%A0%86/" style="font-size: 1.1em; color: #999">二叉堆</a> <a href="/tags/%E7%AE%A1%E9%81%93%E6%B5%81/" style="font-size: 1.1em; color: #999">管道流</a> <a href="/tags/mysql/" style="font-size: 1.1em; color: #999">mysql</a> <a href="/tags/lockfile/" style="font-size: 1.1em; color: #999">lockfile</a> <a href="/tags/this%E7%BB%91%E5%AE%9A/" style="font-size: 1.1em; color: #999">this绑定</a> <a href="/tags/npm/" style="font-size: 1.3em; color: #99a1ac">npm</a> <a href="/tags/%E9%85%8D%E7%BD%AE/" style="font-size: 1.1em; color: #999">配置</a> <a href="/tags/%E8%85%BE%E8%AE%AF/" style="font-size: 1.1em; color: #999">腾讯</a> <a href="/tags/hive/" style="font-size: 1.1em; color: #999">hive</a> <a href="/tags/%E7%BA%A2%E9%BB%91%E6%A0%91/" style="font-size: 1.1em; color: #999">红黑树</a> <a href="/tags/%E6%95%A3%E5%88%97%E8%A1%A8/" style="font-size: 1.1em; color: #999">散列表</a> <a href="/tags/%E6%A1%86%E6%9E%B6/" style="font-size: 1.5em; color: #99a9bf">框架</a> <a href="/tags/%E4%BA%8B%E4%BB%B6%E9%A9%B1%E5%8A%A8/" style="font-size: 1.1em; color: #999">事件驱动</a> <a href="/tags/angular/" style="font-size: 1.1em; color: #999">angular</a> <a href="/tags/async/" style="font-size: 1.1em; color: #999">async</a> <a href="/tags/nestjs/" style="font-size: 1.2em; color: #999da3">nestjs</a> <a href="/tags/%E5%AF%BC%E5%85%A5/" style="font-size: 1.1em; color: #999">导入</a> <a href="/tags/Vuex/" style="font-size: 1.1em; color: #999">Vuex</a> <a href="/tags/%E9%80%92%E5%BD%92/" style="font-size: 1.1em; color: #999">递归</a> <a href="/tags/PATH%E6%A8%A1%E5%9D%97/" style="font-size: 1.1em; color: #999">PATH模块</a> <a href="/tags/vue-router/" style="font-size: 1.2em; color: #999da3">vue router</a> <a href="/tags/pdf/" style="font-size: 1.1em; color: #999">pdf</a> <a href="/tags/FS%E6%A8%A1%E5%9D%97/" style="font-size: 1.1em; color: #999">FS模块</a> <a href="/tags/%E7%AC%AC%E4%B8%89%E6%96%B9%E6%A8%A1%E5%9D%97/" style="font-size: 1.1em; color: #999">第三方模块</a> <a href="/tags/express%E8%B7%AF%E7%94%B1/" style="font-size: 1.1em; color: #999">express路由</a> <a href="/tags/%E6%A8%A1%E5%9D%97%E5%8C%96/" style="font-size: 1.1em; color: #999">模块化</a></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 伍新奎</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://lib.baomitu.com/fancyapps-ui/5.0.24/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div></div></body></html>